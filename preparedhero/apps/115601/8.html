"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return o};var c,o={},t=Object.prototype,u=t.hasOwnProperty,l=Object.defineProperty||function(t,e,n){t[e]=n.value},e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",a=e.toStringTag||"@@toStringTag";function i(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{i({},"")}catch(c){i=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var a,i,o,s,e=e&&e.prototype instanceof g?e:g,e=Object.create(e.prototype),r=new C(r||[]);return l(e,"_invoke",{value:(a=t,i=n,o=r,s=d,function(t,e){if(s===f)throw Error("Generator is already running");if(s===y){if("throw"===t)throw e;return{value:c,done:!0}}for(o.method=t,o.arg=e;;){var n=o.delegate;if(n){n=function t(e,n){var r=n.method,a=e.iterator[r];if(a===c)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=c,t(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;r=p(a,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,m;a=r.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=c),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}(n,o);if(n){if(n===m)continue;return n}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(s===d)throw s=y,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);s=f;n=p(a,i,o);if("normal"===n.type){if(s=o.done?y:h,n.arg===m)continue;return{value:n.arg,done:o.done}}"throw"===n.type&&(s=y,o.method="throw",o.arg=n.arg)}})}),e}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}o.wrap=s;var d="suspendedStart",h="suspendedYield",f="executing",y="completed",m={};function g(){}function _(){}function v(){}var e={},w=(i(e,r,function(){return this}),Object.getPrototypeOf),w=w&&w(w(P([]))),b=(w&&w!==t&&u.call(w,r)&&(e=w),v.prototype=g.prototype=Object.create(e));function k(t){["next","throw","return"].forEach(function(e){i(t,e,function(t){return this._invoke(e,t)})})}function x(o,s){var e;l(this,"_invoke",{value:function(n,r){function t(){return new s(function(t,e){!function e(t,n,r,a){var i,t=p(o[t],o,n);if("throw"!==t.type)return(n=(i=t.arg).value)&&"object"==_typeof(n)&&u.call(n,"__await")?s.resolve(n.__await).then(function(t){e("next",t,r,a)},function(t){e("throw",t,r,a)}):s.resolve(n).then(function(t){i.value=t,r(i)},function(t){return e("throw",t,r,a)});a(t.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}})}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function P(e){if(e||""===e){var n,t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return n=-1,(t=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=c,t.done=!0,t}).next=t}throw new TypeError(_typeof(e)+" is not iterable")}return l(b,"constructor",{value:_.prototype=v,configurable:!0}),l(v,"constructor",{value:_,configurable:!0}),_.displayName=i(v,a,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,i(t,a,"GeneratorFunction")),t.prototype=Object.create(b),t},o.awrap=function(t){return{__await:t}},k(x.prototype),i(x.prototype,n,function(){return this}),o.AsyncIterator=x,o.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var i=new x(s(t,e,n,r),a);return o.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},k(b),i(b,a,"Generator"),i(b,r,function(){return this}),i(b,"toString",function(){return"[object Generator]"}),o.keys=function(t){var e,n=Object(t),r=[];for(e in n)r.push(e);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},o.values=P,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=c)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return i.type="throw",i.arg=n,r.next=t,e&&(r.method="next",r.arg=c),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var a=this.tryEntries[e],i=a.completion;if("root"===a.tryLoc)return t("end");if(a.tryLoc<=this.prev){var o=u.call(a,"catchLoc"),s=u.call(a,"finallyLoc");if(o&&s){if(this.prev<a.catchLoc)return t(a.catchLoc,!0);if(this.prev<a.finallyLoc)return t(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return t(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return t(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}var i=(a=a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc?null:a)?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n,r,a=this.tryEntries[e];if(a.tryLoc===t)return"throw"===(n=a.completion).type&&(r=n.arg,E(a)),r}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=c),m}},o}function ownKeys(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(t,e,n){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function asyncGeneratorStep(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,a)}function _asyncToGenerator(s){return function(){var t=this,o=arguments;return new Promise(function(e,n){var r=s.apply(t,o);function a(t){asyncGeneratorStep(r,e,n,a,i,"next",t)}function i(t){asyncGeneratorStep(r,e,n,a,i,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_toPropertyKey(r.key),r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}var instance,fPayKlarna=function(){return _createClass(function t(e,n){_classCallCheck(this,t),this.fpay=e,this.config=null,this.method=n,this.userGatewayId=n.user_gateway_id,(n.instance=this).fpay.klarnaInstance=this},[{key:"isLoaded",value:function(){return"undefined"!=typeof Klarna}},{key:"loadJs",value:function(t){this.isLoaded()?t():(funnelish.loadScript("https://x.klarnacdn.net/kp/lib/v1/api.js",t),this.addHooks())}},{key:"loadSettings",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n,r=this,a=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=(e=0<a.length&&void 0!==a[0]?a[0]:null)||this.getProductsArray(),t.next=4,funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(this.method.gateway_id,"/settings"),_objectSpread(_objectSpread({},funnelish.getAuthHeader()),{},{user_gateway_id:this.userGatewayId,app_id:this.fpay.id,country:funnelish.countries.country,currency:funnelish.currency(),products:e,current_client_token:this.config&&this.config.session?this.config.session.client_token:"",discount_id:funnelish.discount?funnelish.discount.discount_id:null,is_oto:funnelish.isOTO()}));case 4:if("failed"===(n=t.sent).status)return console.error("Something went wrong",n),t.abrupt("return");t.next=8;break;case 8:this.config=n,this.loadJs(function(){return r.setup()});case 10:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"categories",value:function(){return this.config.session.payment_method_categories||[]}},{key:"setup",value:function(){var a,t,i,o=this;(funnelish.isOTO()||funnelish.isOrderForm())&&(this.config&&this.config.session?this.config.error?(console.error(this.config.error),this.fpay.showError(this.config.error)):(a=[],i="klarna",i=funnelish.isOTO()?((a=document.querySelector(".klarna-hidden-pf-options"))||((t=document.createElement("div")).className="klarna-hidden-pf-options hidden",document.body.appendChild(t),a=document.querySelector(".klarna-hidden-pf-options")),funnelish.getCookie("fpay_klarna_category")||"klarna"):(t=(a=document.querySelector(".payment-form .pf-options")).querySelector(".pf-header.klarna [name='checkout[payment_gateway]']:checked"))?t.dataset.identifier:null,Klarna.Payments.init({client_token:this.config.session.client_token}),this.categories().length?(a.querySelectorAll(".pf-option.klarna").forEach(function(t){return t.remove()}),this.categories().forEach(function(e){var t='<label class="pf-header klarna '.concat(e.identifier,'">\n\t\t\t\t\t\t\t<input type="radio" data-identifier="').concat(e.identifier,'" \n\t\t\t\t\t\t\t\tgroup-id="').concat(o.method.group_id,'" user-gateway-id="').concat(o.method.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(o.method.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<span>').concat(e.name||"Buy now, Pay later",'</span>\n\t\t\t\t\t\t\t<img class="pf-klarna-logo" src="').concat(e.asset_urls.descriptive,'" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<div class="pf-content klarna ').concat(e.identifier,'" data-identifier="').concat(e.identifier,'"></div>'),n=document.createElement("div"),r=(n.innerHTML=t,n.className="pf-option klarna",a.appendChild(n),a.querySelector(".pf-header.klarna.".concat(e.identifier," [name='checkout[payment_gateway]']")));r&&r.addEventListener("change",function(){o.fpay.checkGateway()}),Klarna.Payments.load({container:".pf-option.klarna .pf-content.".concat(e.identifier),payment_method_category:e.identifier},function(t){i&&e.identifier===i&&r&&(r.checked=!0,r.dispatchEvent(new Event("change",{bubbles:!0})))})})):this.fpay.showError("Try a different payment method")):this.fpay.showError("Try a different payment method"))}},{key:"addHooks",value:function(){var e=this;funnelish.on("discount_applied",function(){e.loadSettings()}),document.querySelectorAll('input[name="product-id"], .product-list .pl-item .pl-variant-option input').forEach(function(t){t.addEventListener("change",function(){e.loadSettings()})})}},{key:"getProductsArray",value:function(){var e=[],t=funnelish.getSelectedProducts()||[];return(t=!t.length&&funnelish.products&&0<funnelish.products.length?[{product:funnelish.products[0],qty:1}]:t).forEach(function(t){t.product&&e.push({product_id:t.product.id,qty:t.qty,variant_option1:t.variant_option1,variant_option2:t.variant_option2,variant_option3:t.variant_option3})}),e}},{key:"getVariantPrice",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=t&&t.price||0;return n=e&&(t=t.options?t.options.find(function(t){return t.title===e}):null)&&t.price?t.price:n}},{key:"authorizeOto",value:function(e,t){t.forEach(function(t){t.product=funnelish.findProduct(t.product_id)});["first_name","last_name","full_name","email","phone","address","zip","state","city","country","shipping_address","shipping_zip","shipping_state","shipping_city","shipping_country"].forEach(function(t){e[t]=localStorage.getItem("fnsh.core.customer.".concat(t))}),e.optin_email=e.email,this.authorize(e,t)}},{key:"authorize",value:function(n,r){var a=this,i=0,o=[],t=document.querySelector(".pf-option.klarna [name='checkout[payment_gateway]']:checked"),s=t?t.dataset.identifier:null;console.log("authorize","products",r,"customer",n),r.forEach(function(t){var e;t.product&&(e=[t.variant_option1,t.variant_option2,t.variant_option3].filter(Boolean).join(" / "),e=100*a.getVariantPrice(t.product,e),i+=e*t.qty,e={type:"physical",reference:t.product.id+"",name:t.product.name,quantity:t.qty,unit_price:e,tax_rate:0,total_amount:e*t.qty,total_discount_amount:0,total_tax_amount:0,product_url:window.location.href},t.product.imageUrl&&(e.image_url=t.product.imageUrl),o.push(e))}),console.log("products",r,"lines",o,"category",s),Klarna.Payments.authorize({payment_method_category:s||"klarna"},{purchase_country:funnelish.countries.country,purchase_currency:funnelish.currency(),billing_address:{given_name:n.first_name,family_name:n.last_name,email:n.optin_email,street_address:n.address||n.shipping_address,postal_code:n.zip||n.shipping_zip,city:n.city||n.shipping_city,region:n.state||n.shipping_state,phone:n.phone,country:n.country||n.shipping_country},shipping_address:{given_name:n.first_name,family_name:n.last_name,email:n.optin_email,street_address:n.shipping_address||n.address,postal_code:n.shipping_zip||n.zip,city:n.shipping_city||n.city,region:n.shipping_state||n.state,phone:n.phone,country:n.shipping_country||n.country},order_amount:i,order_lines:o,customer:{}},function(t){var e;console.debug(t),t.error&&t.error.invalid_fields?a.fpay.showError("Invalid fields: "+t.error.invalid_fields.join(", ")+"."):t.approved?t.approved&&((e=t.authorization_token)?funnelish.isOTO()?a.payOto(n,r,e,{category:s}):a.fpay.pay(r,null,e,{category:s}):a.fpay.showError("Invalid token, try a different payment method.")):(console.error("failed:",t),a.fpay.showError("Try a different payment method."))})}},{key:"payOto",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r){var a,i,o,s,c,u=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=3<u.length&&void 0!==u[3]?u[3]:null,i=this.fpay.getCID(),o=this.fpay.getNumCookie("fpay_method_group_id"),s=this.fpay.getNumCookie("fpay_user_gateway_id"),this.fpay.getNumCookie("fpay_gateway_id"),s={user_gateway_id:s,gateway_group_id:o,cid:i,extra:a,token:r},funnelish.startLoading(),t.prev=7,t.next=10,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),s),{},{customer:e,products:n,is_oto:!0,discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 10:if((c=t.sent).success){t.next=15;break}throw c.error;case 15:c.result.goto?window.location=c.result.goto:this.fpay.showError(c);case 16:t.next=23;break;case 18:t.prev=18,t.t0=t.catch(7),funnelish.stopLoading(),this.fpay.showError(this.fpay.parseError(t.t0)),console.error(t.t0);case 23:return t.prev=23,funnelish.stopLoading(),t.finish(23);case 26:case"end":return t.stop()}},t,this,[[7,18,23,26]])})),function(t,e,n){return r.apply(this,arguments)})}]);var r,t}(),fPayMollie=function(){return _createClass(function t(e,n){_classCallCheck(this,t),this.mollie=null,this.fpay=e,this.config=null,this.method=n,this.userGatewayId=n.user_gateway_id,(n.instance=this).fpay.mollieInstance=this},[{key:"isLoaded",value:function(){return"undefined"!=typeof Mollie}},{key:"loadJs",value:function(t){this.isLoaded()?t():funnelish.loadScript("https://js.mollie.com/v1/mollie.js",t)}},{key:"loadSettings",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(this.method.gateway_id,"/settings"),_objectSpread(_objectSpread({},funnelish.getAuthHeader()),{},{user_gateway_id:this.userGatewayId,app_id:this.fpay.id,country:funnelish.countries.country,currency:funnelish.currency(),products:[],current_client_token:this.config&&this.config.session?this.config.session.client_token:"",discount_id:funnelish.discount?funnelish.discount.discount_id:null,is_oto:funnelish.isOTO()}));case 3:if("failed"===(e=t.sent).status)return console.error("Something went wrong",e),t.abrupt("return");t.next=7;break;case 7:this.config=e,this.loadJs(function(){return n.setup()});case 9:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})},{key:"getLocale",value:function(){var t=navigator.language;return["en_US","nl_NL","nl_BE","fr_FR","fr_BE","de_DE","de_AT","de_CH","es_ES","ca_ES","pt_PT","it_IT","nb_NO","sv_SE","fi_FI","da_DK","is_IS","hu_HU","pl_PL","lv_LV","lt_L"].includes(t)?t:"en_US"}},{key:"setup",value:function(){var t;(funnelish.isOTO()||funnelish.isOrderForm())&&(this.config&&this.config.mollie_profile_id?this.config.error?(console.error(this.config.error),this.fpay.showError(this.config.error)):this.method.gateway_id!==this.fpay.MOLLIE||(this.mollie=Mollie(this.config.mollie_profile_id,{locale:this.getLocale(),testmode:funnelish.isTestMode()}),funnelish.isOTO())||(t={styles:{base:{color:"dark"===this.fpay.theme?"#c7c7c7":"#000000",fontSize:"16px","::placeholder":{color:"dark"===this.fpay.theme?"#CFD7DF":"#c6ced6"}},valid:{color:"dark"===this.fpay.theme?"#0ad20a":"#090"}}},this.mollie.createComponent("cardHolder",t).mount("#card_cardholder_container"),this.mollie.createComponent("cardNumber",t).mount("#card_number_container"),this.mollie.createComponent("expiryDate",t).mount("#mm_yy_container"),this.mollie.createComponent("verificationCode",t).mount("#cvc_container")):this.fpay.showError("Try a different payment method"))}},{key:"getToken",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.mollie.createToken();case 3:if(n=t.sent,e=n.token,n=n.error)return this.fpay.showError(n),t.abrupt("return");t.next=9;break;case 9:return t.abrupt("return",e);case 12:return t.prev=12,t.t0=t.catch(0),this.fpay.showError(t.t0),t.abrupt("return",null);case 16:case"end":return t.stop()}},t,this,[[0,12]])})),function(){return t.apply(this,arguments)})},{key:"payOto",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r){var a,i,o,s,c,u=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=3<u.length&&void 0!==u[3]?u[3]:null,i=this.fpay.getCID(),o=this.fpay.getNumCookie("fpay_method_group_id"),s=this.fpay.getNumCookie("fpay_user_gateway_id"),this.fpay.getNumCookie("fpay_gateway_id"),s={user_gateway_id:s,gateway_group_id:o,cid:i,extra:a,token:r},funnelish.startLoading(),t.prev=7,t.next=10,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),s),{},{customer:e,products:n,is_oto:!0,discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 10:if((c=t.sent).success){t.next=15;break}throw c.error;case 15:c.result.goto?window.location=c.result.goto:this.fpay.showError(c);case 16:t.next=23;break;case 18:t.prev=18,t.t0=t.catch(7),funnelish.stopLoading(),this.fpay.showError(this.fpay.parseError(t.t0)),console.error(t.t0);case 23:return t.prev=23,funnelish.stopLoading(),t.finish(23);case 26:case"end":return t.stop()}},t,this,[[7,18,23,26]])})),function(t,e,n){return r.apply(this,arguments)})}]);var r,t,e}(),fPayAirwallex=function(){return _createClass(function t(e,n){_classCallCheck(this,t),this.loaded=!1,this.airwallex=null,this.fpay=e,this.config=null,this.method=n,this.userGatewayId=n.user_gateway_id,(n.instance=this).cardNumber=null},[{key:"banks",value:function(){return[{bank_name:"abn_amro",display_name:"ABN AMRO Bank",logo_url:"https://checkout.airwallex.com/static/media/abn_amro.911bab29.svg"},{bank_name:"asn",display_name:"ASN Bank",logo_url:"https://checkout.airwallex.com/static/media/asn.257601a1.svg"},{bank_name:"bunq",display_name:"Bunq",logo_url:"https://checkout.airwallex.com/static/media/bunq.42b8377e.svg"},{bank_name:"ing",display_name:"ING Bank",logo_url:"https://checkout.airwallex.com/static/media/ing.5c63aa8b.svg"},{bank_name:"knab",display_name:"Knab",logo_url:"https://checkout.airwallex.com/static/media/knab.38031ef6.svg"},{bank_name:"n26",display_name:"N26",logo_url:"https://checkout.airwallex.com/static/media/n26.d2969129.svg"},{bank_name:"rabobank",display_name:"Rabobank",logo_url:"https://checkout.airwallex.com/static/media/rabobank.93eb73c4.svg"},{bank_name:"regiobank",display_name:"RegioBank",logo_url:"https://checkout.airwallex.com/static/media/regiobank.fd943cf0.svg"},{bank_name:"revolut",display_name:"Revolut",logo_url:"https://checkout.airwallex.com/static/media/revolut.d49f9b28.svg"},{bank_name:"sns",display_name:"SNS Bank",logo_url:"https://checkout.airwallex.com/static/media/sns.885ea97f.svg"},{bank_name:"triodos",display_name:"Triodos Bank",logo_url:"https://checkout.airwallex.com/static/media/triodos.4e8605de.svg"},{bank_name:"van_lanschot_baniers",display_name:"Van Lanschot Baniers",logo_url:"https://checkout.airwallex.com/static/media/van_lanschot_baniers.88a3f831.svg"},{bank_name:"yoursafe",display_name:"Yoursafe",logo_url:"https://checkout.airwallex.com/static/media/yoursafe.123.svg"}]}},{key:"isLoaded",value:function(){return"undefined"!=typeof Airwallex}},{key:"loadJs",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function t(){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isLoaded()){t.next=3;break}return t.next=3,this.loadScript("https://checkout.airwallex.com/assets/elements.bundle.min.js");case 3:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})},{key:"loadScript",value:function(r){return new Promise(function(t,e){var n=document.createElement("script");n.src=r,n.onload=t,n.onerror=e,document.head.appendChild(n)})}},{key:"loadSettings",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=!1,this.fpay.loaded||(this.fpay.loaded=!0,e=!0),t.next=5,funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(this.method.gateway_id,"/settings"),_objectSpread(_objectSpread({},funnelish.getAuthHeader()),{},{user_gateway_id:this.userGatewayId,app_id:this.fpay.id,country:funnelish.countries.country,currency:funnelish.currency(),products:[],current_client_token:this.config&&this.config.session?this.config.session.client_token:"",discount_id:funnelish.discount?funnelish.discount.discount_id:null,is_oto:funnelish.isOTO()}));case 5:if("failed"===(n=t.sent).status)return console.error("Something went wrong",n),t.abrupt("return");t.next=9;break;case 9:if(this.config=n,e)return t.next=13,this.loadJs();t.next=13;break;case 13:return t.next=15,this.setup();case 15:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)})},{key:"setupIdeal",value:function(){var t=document.querySelector(".fpay-ideal-container"),n=document.createElement("select");n.className="fpay-airwallex-select",this.banks().forEach(function(t){var e=document.createElement("option");e.value=t.bank_name,e.text=t.display_name,n.appendChild(e)}),t.appendChild(n)}},{key:"setup",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n,r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(funnelish.isOTO()||funnelish.isOrderForm()){t.next=2;break}return t.abrupt("return");case 2:if(this.config&&this.config.is_connected){t.next=5;break}return this.fpay.showError("Try a different payment method"),t.abrupt("return");case 5:if(this.config.error)return console.error(this.config.error),this.fpay.showError(this.config.error),t.abrupt("return");t.next=9;break;case 9:if(this.fpay.airwallexLoaded?console.log("airwallexInstance init ignored"):(this.fpay.airwallexLoaded=!0,console.log("airwallexInstance init"),Airwallex.init({env:this.config.env||"demo",origin:window.location.origin}),console.log("airwallexInstance inited ")),this.method.gateway_id===this.fpay.AIRWALLEX_IDEAL)return this.setupIdeal(),t.abrupt("return");t.next=15;break;case 15:if(this.method.gateway_id!==this.fpay.AIRWALLEX)return t.abrupt("return");t.next=17;break;case 17:if(!funnelish.isOTO()){e={};try{e=JSON.parse(this.method.info)}catch(t){console.warn(t)}this.cardNumber=Airwallex.createElement("cardNumber",{placeholder:e.cc||null,style:{base:{fontFamily:"monospace",color:"dark"===this.fpay.theme?"#c7c7c7":"#000000"}}}),this.cardElement=this.cardNumber.mount("card_number_container"),n=Airwallex.createElement("expiry",{placeholder:e.expiry||null,style:{base:{fontFamily:"monospace",color:"dark"===this.fpay.theme?"#c7c7c7":"#000000"}}}),this.expiryElement=n.mount("mm_yy_container"),n=Airwallex.createElement("cvc",{placeholder:e.cvc||null,style:{base:{fontFamily:"monospace",color:"dark"===this.fpay.theme?"#c7c7c7":"#000000"}}}),this.cvcElement=n.mount("cvc_container"),e=function(t){var e=t.detail,n=e.complete,e=e.error,t=t.target;t&&(e&&"required"===e.code||t.classList.remove("error"),n?t.classList.add("complete"):t.classList.remove("complete"))},n=function(t){var e=t.detail.complete,n=t.detail.error,t=t.target;t&&t.classList.remove("active"),n&&"required"!==n.code?t.classList.add("error"):t.classList.remove("error"),e&&t.classList.add("complete")},r=function(t){t=t.target;t&&t.classList.add("active")},this.cardElement.addEventListener("onChange",e),this.cardElement.addEventListener("onFocus",r),this.cardElement.addEventListener("onBlur",n),this.expiryElement.addEventListener("onChange",e),this.expiryElement.addEventListener("onFocus",r),this.expiryElement.addEventListener("onBlur",n),this.cvcElement.addEventListener("onChange",e),this.cvcElement.addEventListener("onFocus",r),this.cvcElement.addEventListener("onBlur",n)}case 18:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"generateAddress",value:function(t){var e={};return(t.country||t.shipping_country)&&(e.country_code=t.country||t.shipping_country),(t.zip||t.shipping_zip)&&(e.postcode=t.zip||t.shipping_zip),(t.address||t.shipping_address)&&(e.street=t.address||t.shipping_address),t.state&&(e.state=t.state),(t.city||t.shipping_city)&&(e.city=t.city),"UK"===e.country_code&&(e.country_code="GB"),e}},{key:"generateBilling",value:function(t){var e=this.generateAddress(t),e={email:t.optin_email,first_name:t.first_name,last_name:t.last_name,address:e};return t.phone&&(e.phone_number=t.phone),e}},{key:"iDealPay",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r){var a,i;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=document.querySelector(".fpay-airwallex-select"))&&a.value){t.next=7;break}return funnelish.stopLoading(),this.fpay.showError("no bank selected, select a bank first"),console.error("no bank selected",a),t.abrupt("return");case 7:return e.extra={bank_name:a.value},t.next=10,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),e),{},{customer:n,products:r,is_oto:funnelish.isOTO(),discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 10:if((i=t.sent).error)throw i.error;t.next=15;break;case 15:i.result.goto?(window.location=i.result.goto,t.next=20):t.next=19;break;case 19:throw"unknown payment status!";case 20:t.next=27;break;case 22:t.prev=22,t.t0=t.catch(0),funnelish.stopLoading(),this.fpay.showError(this.fpay.parseError(t.t0)),console.error(t.t0);case 27:return t.prev=27,t.finish(27);case 29:case"end":return t.stop()}},t,this,[[0,22,27,29]])})),function(t,e,n){return a.apply(this,arguments)})},{key:"bancontactPay",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r){var a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),e),{},{customer:n,products:r,is_oto:funnelish.isOTO(),discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 3:if((a=t.sent).error)throw a.error;t.next=8;break;case 8:a.result.goto?(window.location=a.result.goto,t.next=13):t.next=12;break;case 12:throw"unknown payment status!";case 13:t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),funnelish.stopLoading(),this.fpay.showError(this.fpay.parseError(t.t0)),console.error(t.t0);case 20:return t.prev=20,t.finish(20);case 22:case"end":return t.stop()}},t,this,[[0,15,20,22]])})),function(t,e,n){return r.apply(this,arguments)})},{key:"pay",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.result){t.next=3;break}return console.error("something is wrong! ",e),t.abrupt("return");case 3:return n=e.result,this.email,t.next=7,Airwallex.createPaymentConsent({intent_id:n.reference,customer_id:n.customer_id,client_secret:n.client_secret,currency:funnelish.currency(),element:this.cardNumber,next_triggered_by:"merchant"});case 7:return r=t.sent,t.next=10,Airwallex.getPaymentIntent(n.reference,n.client_secret);case 10:a=t.sent,console.log("intent",a,"consent",r),a&&"SUCCEEDED"===a.status?window.location=a.return_url+"?payment_consent_id=".concat(a.payment_consent_id,"&payment_intent_id=").concat(a.id):this.fpay.showError(r.error||"something went wrong! try again later.");case 13:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)})},{key:"payOto",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.result){t.next=3;break}return console.error("something is wrong! ",e),t.abrupt("return");case 3:(n=e.result).goto&&(r=funnelish.getCookie("fpay_airwallex_consent_id"),window.location=n.goto+"?payment_consent_id=".concat(r,"&payment_intent_id=").concat(n.reference));case 5:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})}]);var e,n,r,a,t,i,o}(),expressCheckout=function(){return _createClass(function t(e){_classCallCheck(this,t),this.elements=null,this.fpay=e,this.props={theme:"",emailRequired:!1,shippingAddressRequired:!1,billingAddressRequired:!1,phoneNumberRequired:!1,gateway:"stripe",paymentMethods:[{id:"applePay",enabled:!1},{id:"googlePay",enabled:!1},{id:"paypal",enabled:!1}],shippingOptions:[{productId:null,minDelivery:7,maxDelivery:14,label:""}]}},[{key:"amount",value:function(){var e=0;return funnelish.getSelectedProducts().forEach(function(t){if(!t.product)return 0;e+=t.product.price*t.qty}),Math.round(100*e)}},{key:"getProp",value:function(t){return this.props[t]||!1}},{key:"getShippingRates",value:function(){var a=[];return this.props.shippingOptions?(this.props.shippingOptions.forEach(function(t,e){var n=funnelish.findProduct(t.productId),r=0;n?r=Math.round(100*(n.price||0)):console.warn("shipping option product not found,",t.productId),a.push({id:e+"_"+t.productId,displayName:t.label,amount:r,deliveryEstimate:{maximum:{unit:"day",value:t.maxDelivery},minimum:{unit:"day",value:t.minDelivery}}})}),a):[]}},{key:"getLineItems",value:function(){var t=funnelish.getSelectedProducts(),e=[];return t.forEach(function(t){e.push({name:t.product.name,amount:t.qty*t.product.price*100})}),e}},{key:"hasSubscription",value:function(){for(var t=document.querySelectorAll('[name="product-id"][value]'),e=0;e<t.length;e++){var n=t[e];if(n.checked){n=funnelish.findProduct(n.value);if(n&&n.isSub)return!0}}return!1}},{key:"addHooks",value:function(){function e(){t.hasSubscription()?(console.log("sub selected ",n),t.elements.update({mode:"subscription",setupFutureUsage:"off_session"})):(console.log("NO sub selected ",n),t.elements.update({mode:"payment",setupFutureUsage:"on_session"}))}var t=this,n=document.querySelectorAll('[name="product-id"][value]');n.forEach(function(t){t.addEventListener("change",function(){e()})}),e()}},{key:"setupStripe",value:function(t){var e,n,i=this,r=this.fpay.theme||"white",r={buttonHeight:40,buttonTheme:{applePay:"white"===(r="white"!==r?"black":r)?"white-outline":r,googlePay:r,paypal:r},paymentMethods:{amazonPay:"never",applePay:"auto",googlePay:"auto",link:"never",paypal:"never"}},r=(this.elements=this.fpay.stripe.elements({mode:"payment",amount:this.amount(),currency:funnelish.currency().toLowerCase(),setupFutureUsage:this.hasSubscription()?"off_session":"on_session",appearance:{variables:{borderRadius:"6px"}}}),this.elements.create("expressCheckout",r));r.on("ready",function(t){t.availablePaymentMethods&&document.querySelectorAll(".express-checkout").forEach(function(t){t.classList.remove("loading")})}),r.on("click",function(t){var e=i.amount(),e=(console.log("click.newAmount",e),i.elements.update({amount:e}),{shippingAddressRequired:i.getProp("shippingAddressRequired"),emailRequired:i.getProp("emailRequired"),phoneNumberRequired:i.getProp("phoneNumberRequired"),billingAddressRequired:i.getProp("billingAddressRequired"),shippingRates:i.getShippingRates()});e.lineItems=i.getLineItems(),t.resolve(e)}),r.on("shippingratechange",(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=i.amount()+((null==(n=e.shippingRate)?void 0:n.amount)||0),console.log("newAmount",n,e),i.elements.update({amount:n}),e.resolve({lineItems:i.getLineItems()});case 4:case"end":return t.stop()}},t)})),function(t){return e.apply(this,arguments)})),r.on("cancel",function(){funnelish.stopLoading();var t=i.amount();console.log("cancel",t),i.elements.update({amount:t})}),r.on("confirm",(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r,a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.elements.submit();case 2:if(n=t.sent,n=n.submitError)return i.fpay.showError(n),t.abrupt("return");t.next=7;break;case 7:return t.next=9,i.fpay.stripe.createConfirmationToken({elements:i.elements,params:{setup_future_usage:i.hasSubscription()?"off_session":"on_session"}});case 9:return n=t.sent,a=n.error,r=n.confirmationToken,console.log("confirmationToken",r,e,a),t.next=15,i.pay(r,e.shippingRate);case 15:(a=t.sent).error?i.fpay.showError(a.error):null!=(r=a.result)&&r.goto?window.location=a.result.goto:i.fpay.showError("Payment failed. Please try again.");case 17:case"end":return t.stop()}},t)})),function(t){return n.apply(this,arguments)})),r.mount('.express-checkout[data-id="'.concat(t,'"]')),this.addHooks()}},{key:"getStripeGateway",value:function(){var e=this,t=((null==(t=this.fpay)||null==(t=t.funnel_config)?void 0:t.payment_methods)||[]).find(function(t){return t.gateway_id===e.fpay.STRIPEID});return t||null}},{key:"getProducts",value:function(t){var n=this,e=funnelish.getSelectedProducts(),r=[];return e.forEach(function(t){var e;if(!t.product)throw funnelish.stopLoading(),n.fpay.showError(e="Selected product not found, maybe order bump product not created!"),console.error(e),e;r.push({product_id:t.product.id,qty:t.qty,variant_option1:t.variant_option1,variant_option2:t.variant_option2,variant_option3:t.variant_option3})}),t&&t.id&&(e=(e=t.id).substring(e.indexOf("_")+1),e=parseInt(e),r.push({product_id:e,qty:1})),r}},{key:"pay",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a,i,o,s,c;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=this.getStripeGateway(),i=s.group_id,o=s.user_gateway_id,s=s.gateway_id,r={express_checkout:!0,confirmation_token_id:e.id,gateway_group_id:i,user_gateway_id:o,gateway_id:s},funnelish.setCookie("fpay_gateway_id",s,2),funnelish.setCookie("fpay_user_gateway_id",o,2),funnelish.setCookie("fpay_method_group_id",i,2),t.prev=5,funnelish.startLoading(!0),o=(null==e||null==(s=e.payment_method_preview)?void 0:s.billing_details)||{},i=(null==e?void 0:e.shipping)||{},s=o.email||"",c=o.phone||"",a=o.name||i.name||"",i=i.address||{},o=o.address||{},s={optin_email:s,phone:c,full_name:a,shipping_address:((i.line1||"")+" "+(i.line2||"")).trim(),shipping_city:i.city,shipping_country:i.country,shipping_state:i.state,shipping_zip:i.postal_code,billing_address:((o.line1||"")+" "+(o.line2||"")).trim(),billing_city:o.city,billing_country:o.country,billing_state:o.state,billing_zip:o.postal_code},t.next=17,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),r),{},{customer:s,products:this.getProducts(n),is_oto:funnelish.isOTO(),discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 17:return(c=t.sent)&&c.customer_id&&this.fpay.setCID(c.customer_id),t.abrupt("return",c);case 22:t.prev=22,t.t0=t.catch(5),console.error(t.t0),this.fpay.showError(t.t0);case 26:return t.prev=26,t.finish(26);case 28:case"end":return t.stop()}},t,this,[[5,22,26,28]])})),function(t,e){return n.apply(this,arguments)})},{key:"init",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n,r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,funnelish.isOrderForm()){t.next=3;break}return t.abrupt("return");case 3:if(e=this.fpay.funnel_config){t.next=7;break}return console.error("invalid FPay configuration",e),t.abrupt("return");case 7:if(this.props=e.expressCheckoutSettings||{},console.log("props",this.props),0===(n=document.querySelectorAll(".express-checkout")).length)return t.abrupt("return");t.next=12;break;case 12:console.log("els",n[0]),r=n[0].dataset.id||"",this.fpay.isStripeLoaded()&&this.setupStripe(r),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error(t.t0);case 20:case"end":return t.stop()}},t,this,[[0,17]])})),function(){return t.apply(this,arguments)})}]);var t,n}(),appFPay=function(){return _createClass(function t(){_classCallCheck(this,t),this.STRIPEID=1,this.IDEALID=8,this.NMI=9,this.KLARNASTRIPE=10,this.BANCONTACTSTRIPE=11,this.SOFORTSTRIPE=12,this.SEPASTRIPE=13,this.CHECKOUT_COM=14,this.P24STRIPE=15,this.RAZORPAYID=16,this.EPS=17,this.KLARNA=19,this.MOLLIE=20,this.MOLLIE_IDEAL=21,this.MOLLIE_BANCONTACT=22,this.AIRWALLEX=23,this.AIRWALLEX_KLARNA=25,this.AIRWALLEX_IDEAL=26,this.AIRWALLEX_BANCONTACT=27,this.id=8,this.name="Funnelish Pay",this.defaultMethod=null,this.paymentMethods=null,this.config=[],this.funnel_config=[],this.stripe=null,this.stripeCard=null,this.pageUrl=window.funnelish.pageUrl,this.gateways=!1,this.beta=funnelish.isBeta(),this.stripeConfig=null,this.idealConfig=null,this.method_codes=null,this.nmiConfig=null,this.idealBank=null,this.p24Bank=null,this.epsBank=null,this.sepa=null,this.expressCheckout=new expressCheckout(this)},[{key:"init",value:(h=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(window.funnelish.funnelishPay=this).setupCodes(),t.next=4,this.loader_setup(e);case 4:this.handleLoadError();case 5:case"end":return t.stop()}},t,this)})),function(t){return h.apply(this,arguments)})},{key:"handleLoadError",value:function(){var t=new URLSearchParams(window.location.search).get("fpay-error");t&&t.trim()&&this.showError(t)}},{key:"setupCodes",value:function(){function a(t){var e,n=document.querySelector('a[href="#submit-step"]');return n?(e=(n=(e=n.querySelector(".btn-headline"))?e:n)?n.innerText:"Complete Order",'<b id="span_btn_text">"'.concat(e,'"</b>')):'<b id="span_btn_text">"Complete Order"</b>'}var r=this;this.method_codes=[{id:1,name:"Credit Card",html:function(t){return'<div class="pf-option">'.concat(function(t){var e="",n="",r="";return(!(1<arguments.length&&void 0!==arguments[1])||arguments[1])&&(r='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" \n\t\t\t\t\t\t\t\txml:space="preserve">\n\t\t\t\t\t\t\t<path style="fill:#FFFFFF;" d="M512,402.281c0,16.716-13.55,30.267-30.265,30.267H30.265C13.55,432.549,0,418.997,0,402.281V109.717  c0-16.716,13.55-30.266,30.265-30.266h451.47c16.716,0,30.265,13.551,30.265,30.266V402.281L512,402.281z"></path>\n\t\t\t\t\t\t\t<path style="fill:#F79F1A;" d="M113.64,258.035l-12.022-57.671c-2.055-7.953-8.035-10.319-15.507-10.632H30.993l-0.491,2.635  C73.431,202.774,101.836,227.88,113.64,258.035z"></path>\n\t\t\t\t\t\t\t<g>\n\t\t\t\t\t\t\t\t<polygon style="fill:#059BBF;" points="241.354,190.892 205.741,190.892 183.499,321.419 219.053,321.419  "></polygon>\n\t\t\t\t\t\t\t\t<path style="fill:#059BBF;" d="M135.345,321.288l56.01-130.307h-37.691l-34.843,89.028l-3.719-13.442   c-6.83-16.171-26.35-39.446-49.266-54.098l31.85,108.863L135.345,321.288z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#059BBF;" d="M342.931,278.75c0.132-14.819-9.383-26.122-29.887-35.458c-12.461-6.03-20.056-10.051-19.965-16.17   c0-5.406,6.432-11.213,20.368-11.213c11.661-0.179,20.057,2.367,26.624,5.003l3.218,1.475l4.826-28.277   c-7.059-2.637-18.094-5.451-31.895-5.451c-35.157,0-59.904,17.691-60.128,43.064c-0.224,18.763,17.692,29.216,31.181,35.469   c13.847,6.374,18.493,10.453,18.404,16.171c-0.089,8.743-11.035,12.73-21.264,12.73c-14.25,0-21.8-1.965-33.509-6.843l-4.55-2.09   l-4.998,29.249c8.303,3.629,23.668,6.801,39.618,6.933C318.361,323.342,342.663,305.876,342.931,278.75z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#059BBF;" d="M385.233,301.855c4.065,0,40.382,0.045,45.566,0.045c1.072,4.545,4.333,19.565,4.333,19.565h33.011   L439.33,191.027h-27.472c-8.533,0-14.874,2.323-18.628,10.809l-52.845,119.629h37.392   C377.774,321.465,383.848,305.386,385.233,301.855z M409.622,238.645c-0.176,0.357,2.95-7.549,4.737-12.463l2.411,11.256   c0,0,6.792,31.182,8.22,37.704h-29.528C398.411,267.638,409.622,238.645,409.622,238.645z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#059BBF;" d="M481.735,79.451H30.265C13.55,79.451,0,93.001,0,109.717v31.412h512v-31.412   C512,93.001,498.451,79.451,481.735,79.451z"></path>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<path style="fill:#F79F1A;" d="M481.735,432.549H30.265C13.55,432.549,0,418.998,0,402.283v-31.412h512v31.412  C512,418.998,498.451,432.549,481.735,432.549z"></path>\n\t\t\t\t\t\t\t<path style="opacity:0.15;fill:#202121;enable-background:new    ;" d="M21.517,402.281V109.717  c0-16.716,13.551-30.266,30.267-30.266h-21.52C13.55,79.451,0,93.001,0,109.717v292.565c0,16.716,13.55,30.267,30.265,30.267h21.52  C35.069,432.549,21.517,418.997,21.517,402.281z"></path>\n\t\t\t\t\t\t</svg>',n='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 512 512" \n \t\t\t\t\t\t\t\t\txml:space="preserve">\n\t\t\t\t\t\t\t\t<path style="fill:#5286F9;" d="M488.727,66.494H256H23.273C10.42,66.494,0,76.914,0,89.767v332.466  c0,12.853,10.42,23.273,23.273,23.273H256h232.727c12.853,0,23.273-10.42,23.273-23.273V89.767  C512,76.914,501.58,66.494,488.727,66.494z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#FFB655;" d="M273.776,189.773c5.115,5.86,9.57,12.31,13.236,19.242c7.427,14.041,11.655,30.026,11.655,46.986  s-4.228,32.943-11.655,46.986c-3.666,6.932-8.121,13.38-13.236,19.24c-5.264,6.031-11.23,11.427-17.776,16.069  c16.454,11.664,36.523,18.553,58.182,18.553c55.608,0,100.849-45.241,100.849-100.848S369.79,155.152,314.182,155.152  c-21.659,0-41.728,6.886-58.182,18.553C262.544,178.347,268.51,183.744,273.776,189.773z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#D8143A;" d="M287.012,209.016c-3.666-6.934-8.121-13.382-13.236-19.242c-5.267-6.031-11.231-11.425-17.776-16.066  c-16.452-11.667-36.523-18.553-58.182-18.553c-55.608,0-100.848,45.241-100.848,100.848s45.241,100.848,100.848,100.848  c21.659,0,41.73-6.887,58.182-18.553c6.546-4.641,12.51-10.038,17.776-16.067c5.115-5.86,9.57-12.31,13.236-19.24  c7.427-14.043,11.655-30.028,11.655-46.986C298.667,239.041,294.439,223.057,287.012,209.016z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#3D6DEB;" d="M197.818,356.851c-55.608,0-100.848-45.241-100.848-100.848s45.241-100.848,100.848-100.848  c21.659,0,41.728,6.886,58.182,18.553V66.494H23.273C10.42,66.494,0,76.914,0,89.767v332.466c0,12.853,10.42,23.273,23.273,23.273  H256v-107.21C239.546,349.962,219.477,356.851,197.818,356.851z"></path>\n\t\t\t\t\t\t\t</svg>',e='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 291.764 291.764" xml:space="preserve">\n\t\t\t\t\t\t\t<g>\n\t\t\t\t\t\t\t\t<path style="fill:#26A6D1;" d="M18.235,41.025h255.294c10.066,0,18.235,8.169,18.235,18.244v173.235   c0,10.066-8.169,18.235-18.235,18.235H18.235C8.16,250.74,0,242.57,0,232.505V59.269C0,49.194,8.169,41.025,18.235,41.025z"></path>\n\t\t\t\t\t\t\t\t<path style="fill:#FFFFFF;" d="M47.047,113.966l-28.812,63.76h34.492l4.276-10.166h9.774l4.276,10.166h37.966v-7.759l3.383,7.759   h19.639l3.383-7.923v7.923h78.959l9.601-9.902l8.99,9.902l40.555,0.082l-28.903-31.784l28.903-32.058h-39.926l-9.346,9.719   l-8.707-9.719h-85.897l-7.376,16.457l-7.549-16.457h-34.42v7.495l-3.829-7.495C76.479,113.966,47.047,113.966,47.047,113.966z    M53.721,123.02h16.813l19.111,43.236V123.02h18.418l14.761,31l13.604-31h18.326v45.752h-11.151l-0.091-35.851l-16.257,35.851   h-9.975l-16.348-35.851v35.851h-22.94l-4.349-10.257H50.147l-4.34,10.248H33.516C33.516,168.763,53.721,123.02,53.721,123.02z    M164.956,123.02h45.342L224.166,138l14.315-14.98h13.868l-21.071,22.995l21.071,22.73h-14.497l-13.868-15.154l-14.388,15.154   h-44.64L164.956,123.02L164.956,123.02z M61.9,130.761l-7.741,18.272h15.473L61.9,130.761z M176.153,132.493v8.352h24.736v9.309   h-24.736v9.118h27.745l12.892-13.43l-12.345-13.357h-28.292L176.153,132.493z"></path>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</svg>'),'<label class="pf-header">\n\t\t\t\t\t\t<input type="radio" group-id="'.concat(t.group_id,'" \n\t\t\t\t\t\t\t\t\tuser-gateway-id="').concat(t.user_gateway_id,'" gateway-id="').concat(t.gateway_id,'"\n\t\t\t\t\t\t\t\t\t name="checkout[payment_gateway]">\n\t\t\t\t\t\t<span>').concat(t.title||"Credit Card",'</span>\n\t\t\t\t\t\t<ul class="card-icons">\n\t\t\t\t\t\t\t').concat(r,"\n\t\t\t\t\t\t\t").concat(n,"\n\t\t\t\t\t\t\t").concat(e,"\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</label>")}(t)+function(t){var e={};try{e=JSON.parse(t.info)}catch(t){}var n="";return t.gateway_id===r.MOLLIE&&(n='<div class="fields-container">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<span id="lbl_card_holder">'.concat(e.cardHolder||"Name on card",'</span>\n\t\t\t\t\t\t\t\t\x3c!-- Card Number Container --\x3e\n\t\t\t\t\t\t\t\t<div id="card_cardholder_container" class="field__input field__input--iframe-container">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>')),'<div class="pf-content layout-column gateway_'.concat(t.gateway_id,'">\n\t\t\t\t\t\t').concat(n,'\n\t\t\t\t\t\t<div class="fields-container">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t<span id="lbl_card_number">').concat(e.cc||"Card number",'</span>\n\t\t\t\t\t\t\t\t\x3c!-- Card Number Container --\x3e\n\t\t\t\t\t\t\t\t<div id="card_number_container" class="field__input field__input--iframe-container">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flex layout-row">\n\t\t\t\t\t\t\t<div class="fields-container ccMonthWrap">\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<span id="lbl_mm_yy">').concat(e.expiry||"MM / YY",'</span>\n\t\t\t\t\t\t\t\t\t\t\x3c!-- MM / YY Container --\x3e\n\t\t\t\t\t\t\t\t\t<div id="mm_yy_container" class="field__input field__input--iframe-container">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="fields-container ccCVCWrap">\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<span id="lbl_cvc">').concat(e.cvc||"CVC",'</span>\n\t\t\t\t\t\t\t\t\t\t\x3c!-- CVC Container --\x3e\n\t\t\t\t\t\t\t\t\t<div id="cvc_container" class="field__input field__input--iframe-container">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>')}(t),"</div>")}},{id:2,name:"Paypal",html:function(t){return'<div class="pf-option">'.concat('\x3c!-- Paypal --\x3e\n\t\t\t\t\t<label class="pf-header">\n\t\t\t\t\t\t<input type="radio" group-id="'.concat((e=t).group_id,'" \n\t\t\t\t\t\t\t\t\tuser-gateway-id="').concat(e.user_gateway_id,'" gateway-id="').concat(e.gateway_id,'"\n\t\t\t\t\t\t\t\t\t name="checkout[payment_gateway]">\n\t\t\t\t\t\t<img alt="PayPal" class="offsite-payment-gateway-logo" src="/img/billing/paypal.svg">\n\t\t\t\t\t</label>')+(e=t,t="After clicking ".concat(a(),"\n\t\t\t\t\t\t\t, you will be redirected to PayPal to complete your purchase securely."),e&&e.info&&(t=e.info.replace("{SUBMIT_BUTTON}",a())),'<div class="pf-content">\n\t\t\t\t\t\t<img class="icon-offsite" src="/img/offsite-img.png" />\n\t\t\t\t\t\t<p id="paypal_message_p">\n\t\t\t\t\t\t'.concat(t,"\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>")),"</div>");var e}},{id:3,name:"COD",html:function(t){return'<div class="pf-option">'.concat('\n<label class="pf-header">\n\t<input type="radio" group-id="'.concat((e=t).group_id,'" \n\t\t\tuser-gateway-id="').concat(e.user_gateway_id,'" gateway-id="').concat(e.gateway_id,'"\n\t\t\tname="checkout[payment_gateway]">\n\t<span >').concat(e.title||"Cash On Delivery","</span>\n</label>")+(e=t,t="Click ".concat(a()," to complete your purchase.</br>You'll only pay for the order once it's delivered to your address."),e&&e.info&&(t=e.info.replace("{SUBMIT_BUTTON}",a())),'\n<div class="pf-content">\n\t<i style="height: 68px;display: block;">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="" height="68" style="height: 68px;">\n\t\t\t<g id="Tracking" style="fill: #b4b4b4;">\n\t\t\t\t<path d="M61.707,34.293,49.293,21.879A2.978,2.978,0,0,0,47.171,21H30v2h5V38h2V23H47.171a1,1,0,0,1,.708.293L49.586,25H45a2,2,0,0,0-2,2v9a2,2,0,0,0,2,2H60v8a1,1,0,0,1-1,1H56.92a6.991,6.991,0,0,0-13.84,0H28.92a6.991,6.991,0,0,0-13.84,0H13a1,1,0,0,1-1-1V37H10v9a3,3,0,0,0,3,3h2.08a6.978,6.978,0,0,0,2.031,4H2v2H50a7.006,7.006,0,0,0,6.92-6H59a3,3,0,0,0,3-3V35A1,1,0,0,0,61.707,34.293ZM17,48a5,5,0,1,1,5,5A5.006,5.006,0,0,1,17,48Zm9.889,5a6.978,6.978,0,0,0,2.031-4H43.08a6.978,6.978,0,0,0,2.031,4ZM50,53a5,5,0,1,1,5-5A5.006,5.006,0,0,1,50,53ZM45,36V27h6.586L60,35.414V36Z">\n\t\t\t\t</path>\n\t\t\t\t<rect x="21" y="47" width="2" height="2"></rect>\n\t\t\t\t<rect x="49" y="47" width="2" height="2"></rect>\n\t\t\t\t<rect x="2" y="44" width="5" height="2"></rect>\n\t\t\t\t<rect x="4" y="40" width="3" height="2"></rect>\n\t\t\t\t<rect x="5" y="36" width="2" height="2"></rect>\n\t\t\t\t<path d="M15,35A13,13,0,1,0,2,22,13.015,13.015,0,0,0,15,35Zm0-24A11,11,0,1,1,4,22,11.013,11.013,0,0,1,15,11Z"></path>\n\t\t\t\t<path d="M15,31a1,1,0,0,0,.707-.293C16.351,30.063,22,24.29,22,20A7,7,0,0,0,8,20c0,4.29,5.649,10.063,6.293,10.707A1,1,0,0,0,15,31Zm0-16a5.006,5.006,0,0,1,5,5c0,2.566-3.147,6.531-5,8.551-1.853-2.02-5-5.985-5-8.551A5.006,5.006,0,0,1,15,15Z"></path>\n\t\t\t\t<path d="M18,20a3,3,0,1,0-3,3A3,3,0,0,0,18,20Zm-4,0a1,1,0,1,1,1,1A1,1,0,0,1,14,20Z"></path>\n\t\t\t\t<rect x="40" y="40" width="4" height="2"></rect>\n\t\t\t</g>\n\t\t</svg> \n\t</i>\n\t<p class="cod-message">'.concat(t,"</p>\n</div>")),"</div>");var e}},{id:5,name:"iDeal",html:function(t){return'\x3c!-- iDeal --\x3e\n\t\t\t\t\t<div class="pf-option">\n\t\t\t\t\t\t<label class="pf-header ideal">\n\t\t\t\t\t\t\t<input type="radio" group-id="'.concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<img class="gateway-logo ideal" src="https://img.funnelish.com/default/ideal-logo.svg" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t').concat((t=t).gateway_id===r.MOLLIE_IDEAL?(e="After clicking ".concat(a(),"\n\t\t\t\t\t\t\t, you will be redirected to PayPal to complete your purchase securely."),t&&t.info&&(e=t.info.replace("{SUBMIT_BUTTON}",a())),'<div class="pf-content">\n\t\t\t\t\t\t<img class="icon-offsite" src="/img/offsite-img.png" />\n\t\t\t\t\t\t<p id="paypal_message_p">\n\t\t\t\t\t\t'.concat(e,"\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>")):(e=t.info||"Select your bank below",t&&t.info&&(e=t.info.replace("{SUBMIT_BUTTON}",a())),'<div class="pf-content">\n\t\t\t\t\t\t\t\t<span class="select-bank">'.concat(e,'</span>\n\t\t\t\t\t\t\t\t<div class="fpay-ideal-container field__input--iframe-container ideal"></div>\n\t\t\t\t\t\t</div>')),"\n\t\t\t\t\t</div>");var e}},{id:6,name:"Buy now, Pay later",html:function(t){var e,n;return 19===t.gateway_id?"":(n=!1,t.always_show||(e=(funnelish.countries.country||"").toLowerCase(),n=!["gb","us","at","se","es","no","nl","it","de","fr","fi","dk","be"].includes(e)),'\x3c!-- Buy now, Pay later --\x3e\n\t\t\t\t\t<div class="pf-option klarna '.concat(n?"hidden":"",'">\n\t\t\t\t\t\t<label class="pf-header klarna">\n\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<span>').concat(t.title||"Buy now, Pay later",'</span>\n\t\t\t\t\t\t\t<img class="pf-klarna-logo" src="https://img.funnelish.com/default/klarna-logo.svg" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t').concat((e=t,n="After clicking ".concat(a(),"\n\t\t\t\t\t\t\t, you will be redirected to Buy now, Pay later with Klarna to complete your purchase securely."),e&&e.info&&(n=e.info.replace("{SUBMIT_BUTTON}",a())),'<div class="pf-content klarna">\n\t\t\t\t\t\t<img class="icon-offsite" src="/img/offsite-img.png" />\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t'.concat(n,"\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>")),"\n\t\t\t\t\t</div>"))}},{id:7,name:"Bancontact",html:function(t){var e=t.info||"After clicking {SUBMIT_BUTTON}, you will be redirected to Bancontact to complete your purchase securely.",n=(t&&t.info&&(e=t.info.replace("{SUBMIT_BUTTON}",a())),!1);return t.always_show||(n="be"!==(funnelish.countries.country||"").toLowerCase()),'\x3c!-- Bancontact --\x3e\n\t\t\t\t\t<div class="pf-option '.concat(n?"hidden":"",'">\n\t\t\t\t\t\t<label class="pf-header bancontact">\n\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<span>').concat(t.title||"",'</span>\n\t\t\t\t\t\t\t<img class="pf-bancontact-logo"\n\t\t\t\t\t\t\tsrc="https://img.funnelish.com/default/Bancontact-logo.svg" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<div class="pf-content">\n\t\t\t\t\t\t\t<img class="icon-offsite" src="/img/offsite-img.png" />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t').concat(e,"\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>")}},{id:8,name:"Sofort",html:function(t){var e,n=t.info||"After clicking {SUBMIT_BUTTON}, you will be redirected to your banking app to complete your purchase securely.",r=(t&&t.info&&(n=t.info.replace("{SUBMIT_BUTTON}",a())),!1);return t.always_show||(e=(funnelish.countries.country||"").toLowerCase(),r=!["at","be","de","it","nl","es"].includes(e)),'\x3c!-- Sofort --\x3e\n\t\t\t\t\t<div class="pf-option '.concat(r?"hidden":"",'">\n\t\t\t\t\t\t<label class="pf-header sofort">\n\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<span>').concat(t.title||"",'</span>\n\t\t\t\t\t\t\t<img class="pf-sofort-logo"\n\t\t\t\t\t\t\tsrc="https://img.funnelish.com/default/SOFORT-Logo-').concat("white"===funnelish.funnelishPay.theme?"Dark":"Light",'.svg" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<div class="pf-content">\n\t\t\t\t\t\t\t<img class="icon-offsite" src="/img/offsite-img.png" />\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t').concat(n,"\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>")}},{id:9,name:"SEPA",html:function(t){var e={IBAN:"IBAN"};try{e=JSON.parse(t.info)}catch(t){}var n,r=!1;return t.always_show||(n=(funnelish.countries.country||"").toLowerCase(),r=!["ad","at","be","bg","hr","cy","cz","dk","ee","fi","fr","de","gr","hu","is","ie","it","lv","li","lt","lu","mt","mc","nl","no","pl","pt","ro","sm","sk","si","es","se","ch","gb"].includes(n)),'\x3c!-- SEPA --\x3e\n\t\t\t\t\t<div class="pf-option sepa '.concat(r?"hidden":"",'">\n\t\t\t\t\t\t<label class="pf-header sepa">\n\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<span>').concat(t.title||"SEPA Direct Debit",'</span>\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<div class="pf-content">\n\t\t\t\t\t\t\t\t<span class="pf-iban">').concat(e.IBAN||"IBAN",'</span>\n\t\t\t\t\t\t\t\t<div class="pf-sepa-container sepa field__input--iframe-container"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>')}},{id:10,name:"Przelewy24",html:function(t){var e="Select your P24 bank below",n={select_a_bank:e};try{t.info&&(n=JSON.parse(t.info))}catch(t){console.warn("bad P24 method info",t)}n.select_a_bank&&(e=n.select_a_bank.replace("{SUBMIT_BUTTON}",a())),n=!1;return t.always_show||(n="pl"!==(funnelish.countries.country||"").toLowerCase()),'\x3c!-- P24 --\x3e\n\t\t\t\t\t<div class="pf-option '.concat(n?"hidden":"",'">\n\t\t\t\t\t\t<label class="pf-header p24">\n\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<img class="gateway-logo p24" src="https://img.funnelish.com/default/przelewy24_logo_2022.svg" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<div class="pf-content p24">\n\t\t\t\t\t\t\t<span class="select-bank">').concat(e,'</span>\n\t\t\t\t\t\t\t<div class="fpay-p24-container p24"></div>\n\t\t\t\t\t\t\t<span class="info-message _tos" >\n\t\t\t\t\t\t\t\tOświadczam, że zapoznałem się z <a href="https://www.przelewy24.pl/regulamin" target="_blank">regulaminem</a> i \n\t\t\t\t\t\t\t\t<a href="https://www.przelewy24.pl/obowiazekinformacyjny" target="_blank">obowiązkiem informacyjnym</a> \n\t\t\t\t\t\t\t\tserwisu Przelewy24.\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>')}},{id:11,name:"RazorPay",html:function(t){var e=!1;return t.always_show||(e="in"!==(funnelish.countries.country||"").toLowerCase()),'\x3c!-- RazorPay --\x3e\n\t\t\t\t\t\t<div class="pf-option '.concat(e?"hidden":"",'">\n\t\t\t\t\t\t\t<label class="pf-header razorpay">\n\t\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t\t<img class="gateway-logo razorpay" \n\t\t\t\t\t\t\t\tsrc="https://img.funnelish.com/default/razorpay-logo-').concat("dark"===r.theme?"white":"black",'.png" />\n\t\t\t\t\t\t\t</label>\n\t\n\t\t\t\t\t\t\t').concat((e=t,t="After clicking ".concat(a(),", you will be redirected to RazorPay to complete your purchase securely."),e&&e.info&&(t=e.info.replace("{SUBMIT_BUTTON}",a())),'<div class="pf-content">\n\t\t\t\t\t\t<img class="icon-offsite" src="/img/offsite-img.png" />\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t'.concat(t,"\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>")),"\n\t\t\t\t\t\t</div>")}},{id:12,name:"EPS",html:function(t){var e="Select your EPS bank below",n=(n=t.info||{select_a_bank:e}).select_a_bank?n.select_a_bank.replace("{SUBMIT_BUTTON}",a()):e,e=!1;return t.always_show||(e="at"!==(funnelish.countries.country||"").toLowerCase()),'\x3c!-- EPS --\x3e\n\t\t\t\t\t<div class="pf-option '.concat(e?"hidden":"",'">\n\t\t\t\t\t\t<label class="pf-header eps">\n\t\t\t\t\t\t\t<input type="radio" group-id="').concat(t.group_id,'" user-gateway-id="').concat(t.user_gateway_id,'" \n\t\t\t\t\t\t\t\tgateway-id="').concat(t.gateway_id,'" name="checkout[payment_gateway]">\n\t\t\t\t\t\t\t<img class="gateway-logo eps" src="https://img.funnelish.com/default/eps-logo.png" />\n\t\t\t\t\t\t</label>\n\n\t\t\t\t\t\t<div class="pf-content eps">\n\t\t\t\t\t\t\t<span class="select-bank">').concat(n,'</span>\n\t\t\t\t\t\t\t<div class="fpay-eps-container eps"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>')}}]}},{key:"loader_setup",value:(d=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n=JSON.parse(e.funnel_config))&&(this.paymentMethods=n.payment_methods,this.defaultMethod=n.default_method,this.theme=n.theme||"white",this.funnel_config=n),funnelish.isOrderForm())return t.next=5,this.setup_methods();t.next=7;break;case 5:t.next=8;break;case 7:this.setup_oto_step();case 8:funnelish.isTYP()&&this.load_typ_orders();case 9:case"end":return t.stop()}},t,this)})),function(t){return d.apply(this,arguments)})},{key:"payBoxHtml",value:function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"white";return funnelish.isTestMode()&&((e=document.createElement("span")).innerHTML='<span class="test-mode">Test Mode</span>',t.appendChild(e)),t.classList.add(n),t}},{key:"getMethodCode",value:function(t){for(var e in this.method_codes){e=this.method_codes[e];if(e.id==t.group_id)return e}return null}},{key:"appendGateway",value:(p=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r){var a;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=document.createElement("div"),e.appendChild(a),a.outerHTML=n.html(r),t.t0=r.gateway_id,t.next=t.t0===this.NMI?6:t.t0===this.CHECKOUT_COM?9:t.t0===this.RAZORPAYID?12:t.t0===this.KLARNA?15:t.t0===this.MOLLIE?18:t.t0===this.MOLLIE_IDEAL?22:t.t0===this.MOLLIE_BANCONTACT?26:t.t0===this.AIRWALLEX?30:t.t0===this.AIRWALLEX_IDEAL?34:t.t0===this.AIRWALLEX_KLARNA?38:t.t0===this.AIRWALLEX_BANCONTACT?42:46;break;case 6:return t.next=8,this.loadNMISettings(r.user_gateway_id,r);case 8:return t.abrupt("break",46);case 9:return t.next=11,this.loadCheckoutComSettings(r.user_gateway_id,r);case 11:return t.abrupt("break",46);case 12:return t.next=14,this.loadRazorPaySettings(r.user_gateway_id,r);case 14:return t.abrupt("break",46);case 15:return t.next=17,new fPayKlarna(this,r).loadSettings();case 17:return t.abrupt("break",46);case 18:return this.mollie=new fPayMollie(this,r),t.next=21,this.mollie.loadSettings();case 21:return t.abrupt("break",46);case 22:return this.mollieIdeal=new fPayMollie(this,r),t.next=25,this.mollieIdeal.loadSettings();case 25:return t.abrupt("break",46);case 26:return this.mollieBancontact=new fPayMollie(this,r),t.next=29,this.mollieBancontact.loadSettings();case 29:return t.abrupt("break",46);case 30:return this.airwallex=new fPayAirwallex(this,r),t.next=33,this.airwallex.loadSettings();case 33:return t.abrupt("break",46);case 34:return this.airwallexIdeal=new fPayAirwallex(this,r),t.next=37,this.airwallexIdeal.loadSettings();case 37:return t.abrupt("break",46);case 38:return this.airwallexKlarna=new fPayAirwallex(this,r),t.next=41,this.airwallexKlarna.loadSettings();case 41:return t.abrupt("break",46);case 42:return this.airwallexBancontact=new fPayAirwallex(this,r),t.next=45,this.airwallexBancontact.loadSettings();case 45:return t.abrupt("break",46);case 46:case"end":return t.stop()}},t,this)})),function(t,e,n){return p.apply(this,arguments)})},{key:"isStripeLoaded",value:function(){return"undefined"!=typeof Stripe}},{key:"loadStripeJs",value:function(t){this.isStripeLoaded()||window.funnelish.loadScript("https://js.stripe.com/v3/",t)}},{key:"isNMILoaded",value:function(){return"undefined"!=typeof CollectJS}},{key:"loadNMIJs",value:function(t,e){if(!this.isNMILoaded()){var n={};try{e&&e.info&&(n=JSON.parse(e.info))}catch(t){}e=this.nmiConfig.publicKey;window.funnelish.loadScript("https://secure.networkmerchants.com/token/Collect.js",t,{tokenizationKey:e,fieldCcnumberSelector:"#card_number_container",fieldCcnumberTitle:n.cc||"Card Number",fieldCcnumberPlaceholder:"0000 0000 0000 0000",fieldCcexpSelector:"#mm_yy_container",fieldCcexpTitle:n.expiry||"MM / YY",fieldCcexpPlaceholder:"00 / 00",fieldCvvSelector:"#cvc_container",fieldCvvTitle:n.cvc||"CVC",fieldCvvPlaceholder:"***"})}}},{key:"loadNMISettings",value:(l=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.nmiConfig){t.next=9;break}return t.next=3,window.funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(this.NMI,"/settings"),_objectSpread(_objectSpread({},window.funnelish.getAuthHeader()),{},{user_gateway_id:e,app_id:this.id}));case 3:if("failed"===(r=t.sent).status)return console.error("Something went wrong",r),t.abrupt("return");t.next=7;break;case 7:this.nmiConfig=r,this.loadNMIJs(function(){return a.setupNMI(n)});case 9:case"end":return t.stop()}},t,this)})),function(t,e){return l.apply(this,arguments)})},{key:"isCheckoutComLoaded",value:function(){return"undefined"!=typeof Frames}},{key:"loadCheckoutComJs",value:function(t){this.isCheckoutComLoaded()||window.funnelish.loadScript("https://cdn.checkout.com/js/framesv2.min.js",t)}},{key:"loadCheckoutComSettings",value:(u=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.checkoutComConfig){t.next=9;break}return t.next=3,window.funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(n.gateway_id,"/settings"),_objectSpread(_objectSpread({},window.funnelish.getAuthHeader()),{},{user_gateway_id:e,app_id:this.id}));case 3:if("failed"===(r=t.sent).status)return console.error("Something went wrong",r),t.abrupt("return");t.next=7;break;case 7:this.checkoutComConfig=r,this.loadCheckoutComJs(function(){return a.setupCheckoutCom(e,n)});case 9:case"end":return t.stop()}},t,this)})),function(t,e){return u.apply(this,arguments)})},{key:"setupCheckoutCom",value:function(t,e){if(this.checkoutComConfig.error)console.error(this.checkoutComConfig.error);else{var n=this.checkoutComConfig.public_key,e=this.getMethodCode(e),r={};try{r=JSON.parse(e.info)}catch(t){}document.getElementById("card_number_container").classList.add("card-number-frame"),document.getElementById("mm_yy_container").classList.add("expiry-date-frame"),document.getElementById("cvc_container").classList.add("cvv-frame"),Frames.init({publicKey:n,localization:{cardNumberPlaceholder:r.card||"Card number",expiryMonthPlaceholder:r.mm||"MM",expiryYearPlaceholder:r.yy||"YY",cvvPlaceholder:r.cvv||"CVV"},style:{base:{fontWeight:500,fontSize:"16px",height:"40px",padding:"2px 10px",fontSmoothing:"antialiased",color:"dark"===this.theme?"#c7c7c7":"#000000"},autofill:{color:"#e39f48"},focus:{color:"dark"===this.theme?"#c7c7c7":"#000000"},invalid:{color:"#d72829"},placeholder:{base:{color:"dark"===this.theme?"#CFD7DF":"#c6ced6"},focus:{}}}})}}},{key:"isRazorPayLoaded",value:function(){return"undefined"!=typeof Razorpay}},{key:"loadRazorPayJs",value:function(t){this.isRazorPayLoaded()||window.funnelish.loadScript("https://checkout.razorpay.com/v1/checkout.js",t)}},{key:"loadRazorPaySettings",value:(c=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.razorPayConfig){t.next=9;break}return t.next=3,window.funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(n.gateway_id,"/settings"),_objectSpread(_objectSpread({},window.funnelish.getAuthHeader()),{},{user_gateway_id:e,app_id:this.id}));case 3:if("failed"===(r=t.sent).status)return console.error("Something went wrong",r),t.abrupt("return");t.next=7;break;case 7:this.razorPayConfig=r,this.loadRazorPayJs(function(){return a.setupRazorPay(e,n)});case 9:case"end":return t.stop()}},t,this)})),function(t,e){return c.apply(this,arguments)})},{key:"setupRazorPay",value:function(t,e){this.razorPayConfig.error&&console.error(this.razorPayConfig.error)}},{key:"setupNMI",value:function(t){var n=this;if(this.nmiConfig.error)console.error(this.nmiConfig.error);else if(window.funnelish.isOrderForm()){var e={};try{t&&t.info&&(e=JSON.parse(t.info))}catch(t){}CollectJS.configure({callback:function(t){var e;console.log("NMI callback",t),t.token?(e=funnelish.getSelectedProducts(),n.pay(e,null,t.token)):console.error("NMI invalid token",t.token)},variant:"inline",googleFont:"Abel",invalidCss:{"border-color":"#B40E3E",color:"#B40E3E"},validCss:{"border-color":"#26a026",color:"none"},customCss:{color:"dark"===this.theme?"#CFD7DF":"#353535","background-color":"dark"===this.theme?"#525252":"#fff","font-weight":"500",height:"46px","line-height":"46px",padding:"12px","border-style":"solid","border-width":"1px","border-color":"dark"===this.theme?"transparent":"#CFD7DF","border-radius":"5px","font-size":"16px","margin-top":"3px"},focusCss:{"border-color":"dark"===this.theme?"#CFD7DF":"#c6ced6"},fields:{cvv:{placeholder:e.cvc||"CVC"},ccnumber:{placeholder:e.cc||"Credit Card"},ccexp:{placeholder:e.expiry||"MM / YY"}}})}}},{key:"setupStripe",value:function(){var t,e,n,r,a,i;this.stripeConfig.error?console.error(this.stripeConfig.error):(e=this.stripeConfig.account_id,t=this.stripeConfig.stripe_api_key,this.stripeAccountId=e,this.stripe=Stripe(t,{stripeAccount:e}),t=this.stripe.elements(),e={base:{fontWeight:500,fontSize:"16px",fontSmoothing:"antialiased",color:"dark"===this.theme?"#c7c7c7":"#000000",":focus":{color:"dark"===this.theme?"#c7c7c7":"#000000"},"::placeholder":{color:"dark"===this.theme?"#CFD7DF":"#c6ced6"},":-webkit-autofill":{color:"#e39f48"}},invalid:{color:"#d72829","::placeholder":{color:"#FFCCA5"}}},n={focus:"focused",empty:"empty",invalid:"invalid",complete:"complete"},this.getMethodById(this.P24STRIPE)&&(funnelish.isOrderForm()||funnelish.isOTO())&&(r=funnelish.getCookie("fpay_p24_bank")||"",funnelish.isOTO()&&((a=document.createElement("div")).className="fpay-p24-container hidden",document.body.appendChild(a)),e.base.padding="8px 15px",e.base.cursor="pointer !important",e.base.backgroundColor="dark"===this.theme?"#2b252b":"white",a={style:e},r&&(a.value=r),this.p24Bank=t.create("p24Bank",a),this.p24Bank.mount(".fpay-p24-container")),this.getMethodById(this.EPS)&&(r=funnelish.getCookie("fpay_eps_bank")||"",funnelish.isOTO()&&((a=document.createElement("div")).className="fpay-eps-container hidden",document.body.appendChild(a)),e.base.padding="8px 15px",e.base.cursor="pointer !important",e.base.backgroundColor="dark"===this.theme?"#2b252b":"white",a={style:e},r&&(a.value=r),this.epsBank=t.create("epsBank",a),this.epsBank.mount(".fpay-eps-container")),this.getMethodById(this.IDEALID)&&(r=funnelish.getCookie("fpay_ideal_bank")||"",(a=JSON.parse(JSON.stringify(e))).base.padding="8px 15px",a.base.cursor="pointer !important",a.base.backgroundColor="dark"===this.theme?"#2b252b":"white",a={style:a},funnelish.isOTO()&&((i=document.createElement("div")).className="fpay-ideal-container hidden",document.body.appendChild(i),r)&&(a.value=r),funnelish.isOTO()||funnelish.isOrderForm())&&(this.idealBank=t.create("idealBank",a),this.idealBank.mount(".fpay-ideal-container")),this.expressCheckout.init(),window.funnelish.isOrderForm()&&(this.getMethodById(this.STRIPEID)&&(this.cardNumber=t.create("cardNumber",{style:e,classes:n}),this.cardNumber.mount("#card_number_container"),t.create("cardExpiry",{style:e,classes:n}).mount("#mm_yy_container"),t.create("cardCvc",{style:e,classes:n}).mount("#cvc_container")),this.getMethodById(this.SEPASTRIPE))&&(e.base.padding="8px 15px",e.base.cursor="pointer !important",e.base.backgroundColor="transparent",e.base.iconColor="dark"===this.theme?"white":"#2c2c2c",this.sepa=t.create("iban",{style:e,supportedCountries:["SEPA"],placeholderCountry:funnelish.countries.country||"GB"}),this.sepa.mount(".pf-sepa-container")))}},{key:"getMethodById",value:function(t){for(var e in this.paymentMethods){e=this.paymentMethods[e];if(e.gateway_id===t)return e}return null}},{key:"loadStripeSettings",value:(s=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.stripeConfig){t.next=9;break}return t.next=3,window.funnelish.post("/gateways/".concat(funnelish.funnelId,"/").concat(n,"/settings"),_objectSpread(_objectSpread({},window.funnelish.getAuthHeader()),{},{user_gateway_id:e,app_id:this.id}));case 3:if("failed"===(r=t.sent).status)return console.error("Something went wrong",r),t.abrupt("return");t.next=7;break;case 7:this.stripeConfig=r,this.loadStripeJs(function(){return a.setupStripe()});case 9:case"end":return t.stop()}},t,this)})),function(t,e){return s.apply(this,arguments)})},{key:"setup_methods",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function t(){var e,n,r,a,i,o,s,c,u,l,p=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.paymentMethods||alert("No Payment methods set in Funnelish."),funnelish.on("of_purchase",this.handleOfPurchase,this),e=document.querySelectorAll(".payment-form"),n=0;case 4:if(!(n<e.length)){t.next=33;break}r=e[n],this.payBoxHtml(r,this.theme),(a=document.createElement("div")).className="pf-options",r.appendChild(a),i=!1,o=0,t.t0=_regeneratorRuntime().keys(this.paymentMethods);case 13:if((t.t1=t.t0()).done){t.next=22;break}return s=t.t1.value,s=this.paymentMethods[s],c=this.getMethodCode(s),t.next=19,this.appendGateway(a,c,s);case 19:i&&o||![this.STRIPEID,this.IDEALID,this.KLARNASTRIPE,this.BANCONTACTSTRIPE,this.SOFORTSTRIPE,this.SEPASTRIPE,this.P24STRIPE,this.EPS].includes(s.gateway_id)||(i=!0,o=s.user_gateway_id),t.next=13;break;case 22:if(i)return t.next=25,this.loadStripeSettings(o,this.STRIPEID);t.next=25;break;case 25:(c=document.createElement("div")).innerHTML="<b>Error: </b> &nbsp; <span>Something went wrong, check your details and try again!</span>",c.className="card-error",r.appendChild(c),r.classList.remove("loading");case 30:n++,t.next=4;break;case 33:if(document.querySelectorAll("[name='checkout[payment_gateway]'], [name='product-id']").forEach(function(t){t.addEventListener("change",function(){return p.checkGateway()})}),!this.defaultMethod){t.next=47;break}if(u=document.querySelector("input[name='checkout[payment_gateway]'][group-id='".concat(this.defaultMethod,"']"))){t.next=40;break}return this.selectDefaultOption(),t.abrupt("return");case 40:if(!(l=u.closest(".pf-option"))||l.classList.contains("hidden"))return this.selectDefaultOption(),t.abrupt("return");t.next=44;break;case 44:u.click(),t.next=48;break;case 47:this.selectDefaultOption();case 48:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})},{key:"selectDefaultOption",value:function(){var t=document.querySelector("input[name='checkout[payment_gateway]']:first-child");t&&t.click()}},{key:"handleOfPurchase",value:(o=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.pay(e);case 2:case"end":return t.stop()}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"showError",value:function(e){console.error(e),e=(e="object"===_typeof(e)&&e.message?e.message:e)||"Something went wrong, check your details and try again!";var t=document.querySelectorAll(".payment-form");t.forEach(function(t){t.classList.add("invalid"),t.querySelector(".card-error span").innerText=e}),0<t.length?t[0].scrollIntoView():alert(e),funnelish.stopLoading()}},{key:"hideError",value:function(){document.querySelectorAll(".payment-form").forEach(function(t){t.classList.remove("invalid")})}},{key:"getSelectedGatewayInfo",value:function(){var t,e,n=document.querySelector("input[name='checkout[payment_gateway]']:checked");return n?(t=n.getAttribute("group-id"),e=n.getAttribute("user-gateway-id"),n=n.getAttribute("gateway-id"),{gatewayGroupId:parseInt(t),userGatewayId:parseInt(e),gatewayId:parseInt(n)}):(console.error("Error: no payment method selected."),{})}},{key:"getCheckoutComCardHolder",value:function(t){var e={},n={};return(t.country||t.shipping_country)&&(n.country=t.country||t.shipping_country),(t.zip||t.shipping_zip)&&(n.zip=t.zip||t.shipping_zip),(t.address||t.shipping_address)&&(n.addressLine1=t.address||t.shipping_address),(t.state||t.shipping_state)&&(n.state=t.state||t.shipping_state),(t.city||t.shipping_city)&&(n.city=t.city||t.shipping_city),"UK"===n.country&&(n.country="GB"),e.billingAddress=n,e.name=t.full_name||"",e.phone=t.phone||"",e}},{key:"pay",value:(i=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r,a,i,o,s,c,u,l,p,d,h,f=this,y=arguments;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=1<y.length&&void 0!==y[1]?y[1]:null,r=2<y.length&&void 0!==y[2]?y[2]:null,a=3<y.length&&void 0!==y[3]?y[3]:null,i=funnelish.validateFields(),s=this.getSelectedGatewayInfo(),o=s.gatewayGroupId,d=s.userGatewayId,s=s.gatewayId,c={gateway_group_id:o,user_gateway_id:d,gateway_id:s},funnelish.setCookie("fpay_gateway_id",s,2),funnelish.setCookie("fpay_user_gateway_id",d,2),funnelish.setCookie("fpay_method_group_id",o,2),this.hideError(),funnelish.startLoading(),funnelish.validateOptin(i)){t.next=14;break}return funnelish.stopLoading(),t.abrupt("return");case 14:u=[],e.forEach(function(t){var e;if(!t.product)throw funnelish.stopLoading(),f.showError(e="Selected product not found, maybe order bump product not created!"),console.error(e),e;u.push({product_id:t.product.id,qty:t.qty,variant_option1:t.variant_option1,variant_option2:t.variant_option2,variant_option3:t.variant_option3})}),a&&(c.extra=a),n?(c.payment_reference=n,t.next=87):t.next=21;break;case 21:if(s===this.MOLLIE)return t.next=24,this.mollie.getToken();t.next=31;break;case 24:if(l=t.sent){t.next=28;break}return funnelish.stopLoading(),t.abrupt("return");case 28:c.token=l,t.next=87;break;case 31:if(s===this.STRIPEID)return t.next=34,this.GetStripeToken(i);t.next=41;break;case 34:if(p=t.sent){t.next=38;break}return funnelish.stopLoading(),t.abrupt("return");case 38:c.token=p,t.next=87;break;case 41:if(s!==this.NMI){t.next=50;break}if(r){t.next=47;break}return t.next=45,CollectJS.startPaymentRequest();case 45:return funnelish.stopLoading(),t.abrupt("return");case 47:c.token=r,t.next=87;break;case 50:if(s!==this.CHECKOUT_COM){t.next=68;break}if(r){t.next=66;break}return t.prev=52,Frames.cardholder=this.getCheckoutComCardHolder(i),t.next=56,Frames.submitCard();case 56:d=t.sent,c.token=d.token,t.next=66;break;case 60:return t.prev=60,t.t0=t.catch(52),funnelish.stopLoading(),this.showError(t.t0),console.error(t.t0),t.abrupt("return");case 66:t.next=87;break;case 68:if(s!==this.KLARNA){t.next=77;break}if(r){t.next=74;break}return this.klarnaInstance.authorize(i,e),t.abrupt("return");case 74:c.token=r;case 75:t.next=87;break;case 77:if(s===this.AIRWALLEX_IDEAL)return t.next=80,this.airwallexIdeal.iDealPay(c,i,u);t.next=83;break;case 80:return t.abrupt("return");case 83:if(s===this.AIRWALLEX_BANCONTACT)return t.next=86,this.airwallexBancontact.bancontactPay(c,i,u);t.next=87;break;case 86:return t.abrupt("return");case 87:return t.prev=87,t.next=90,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),c),{},{customer:i,products:u,is_oto:funnelish.isOTO(),discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 90:if((h=t.sent).customer_id&&this.setCID(h.customer_id),h.success){t.next=96;break}throw h.error;case 96:if(s===this.AIRWALLEX)return t.next=99,this.airwallex.pay(h,i);t.next=101;break;case 99:t.next=123;break;case 101:s!==this.MOLLIE?t.next=105:(h.result.goto&&(window.location=h.result.goto),t.next=123);break;case 105:s!==this.KLARNA?t.next=109:(h.result.goto&&(window.location=h.result.goto),t.next=123);break;case 109:[this.KLARNASTRIPE,this.IDEALID,this.P24STRIPE,this.BANCONTACTSTRIPE,this.SOFORTSTRIPE,this.SEPASTRIPE,this.EPS].includes(s)?(this.authPayment(h,i),t.next=123):t.next=113;break;case 113:s!=this.STRIPEID?t.next=117:(h.result.needs_approval?this.authPayment(h,i):window.location=h.result.goto,t.next=123);break;case 117:if(s===this.RAZORPAYID)return t.next=120,this.authRazorPay(h,i);t.next=122;break;case 120:t.next=123;break;case 122:h.result.goto?window.location=h.result.goto:h.result.needs_approval?this.authPayment(h,i):this.showError();case 123:t.next=130;break;case 125:t.prev=125,t.t1=t.catch(87),funnelish.stopLoading(),this.showError(this.parseError(t.t1)),console.error(t.t1);case 130:return t.prev=130,t.finish(130);case 132:case"end":return t.stop()}},t,this,[[52,60],[87,125,130,132]])})),function(t){return i.apply(this,arguments)})},{key:"authRazorPay",value:(a=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a,i,o,s=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=e.result.gateway_data.order,a=e.result.gateway_data.meta,i=e.result.gateway_data.description,"created"!==r.status)return this.showError("order has invalid status",e.gateway_data.status),t.abrupt("return");t.next=7;break;case 7:o=this.razorPayConfig.key_id,["full_name","optin_email","phone"].forEach(function(t){n[t]||(n[t]=localStorage.getItem("fnsh.core.customer.".concat("optin_email"===t?"email":t)))}),o={key:o,amount:r.amount,currency:r.currency,name:i,description:i,callback_url:e.result.goto,order_id:r.id,redirect:!0,handler:function(t){funnelish.stopLoading()},prefill:{name:n.full_name,email:n.optin_email,contact:n.phone},notes:a||{},theme:{color:"#3399cc"}},(o=new Razorpay(o)).on("payment.failed",function(t){s.showError(t.error.description),funnelish.stopLoading()}),funnelish.stopLoading(),o.open(),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),this.showError(t.t0);case 19:case"end":return t.stop()}},t,this,[[0,16]])})),function(t,e){return a.apply(this,arguments)})},{key:"checkGateway",value:function(){var t=document.querySelector("input[name='checkout[payment_gateway]']:checked").closest(".pf-option");document.querySelectorAll(".payment-form .pf-option").forEach(function(t){return t.classList.remove("active")}),t.classList.add("active")}},{key:"GetStripeToken",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function t(e){var n,r;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.generateStripeAddress(e),n={email:e.optin_email,address:n},e.full_name&&(n.name=e.full_name),e.phone&&(n.phone=e.phone),t.next=6,this.stripe.createPaymentMethod({type:"card",card:this.cardNumber,billing_details:n});case 6:if((r=t.sent).error)return this.showError(r.error.message),t.abrupt("return",null);t.next=12;break;case 12:return t.abrupt("return",r.paymentMethod.id);case 13:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)})},{key:"generateStripeAddress",value:function(t){var e={};return(t.country||t.shipping_country)&&(e.country=t.country||t.shipping_country),(t.zip||t.shipping_zip)&&(e.postal_code=t.zip||t.shipping_zip),(t.address||t.shipping_address)&&(e.line1=t.address||t.shipping_address),t.state&&(e.state=t.state),t.city&&(e.city=t.city),"UK"===e.country&&(e.country="GB"),e}},{key:"setCID",value:function(t){funnelish.setCookie("fnsh.core.cid",t,20)}},{key:"getCID",value:function(){return funnelish.getCookie("fnsh.core.cid")}},{key:"getStripeBillingDetails",value:function(t){var e=this.generateStripeAddress(t),e={email:t.optin_email,name:t.full_name,address:e};return t.phone&&(e.phone=t.phone),e}},{key:"getAnyCountry",value:function(t){var e="";return e="UK"===(e=(e=t.country||t.shipping_country?t.country||t.shipping_country:e)||localStorage.getItem("fnsh.core.customer.country")||localStorage.getItem("fnsh.core.customer.shipping_country"))?"GB":e}},{key:"getKlarnaBillingDetails",value:function(t){var e={},e=(e.country=this.getAnyCountry(t),t.optin_email||(t.optin_email=localStorage.getItem("fnsh.core.customer.email")),t.phone||(t.phone=localStorage.getItem("fnsh.core.customer.phone")),{email:t.optin_email,address:e});return t.phone&&(e.phone=t.phone),e}},{key:"setCustomerDetails",value:function(t){t.optin_email||(t.optin_email=funnelish.getCookie("fnsh.core.customer.email")||localStorage.getItem("fnsh.core.customer.email")||""),t.full_name||(t.full_name=funnelish.getCookie("fnsh.core.customer.full_name")||localStorage.getItem("fnsh.core.customer.full_name")||"")}},{key:"authPayment",value:(r=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n,r){var a,i,o,s,c,u,l,p,d,h,f,y;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.result.reference,i=e.result.gateway_id,[this.STRIPEID,this.IDEALID,this.P24STRIPE,this.KLARNASTRIPE,this.BANCONTACTSTRIPE,this.SOFORTSTRIPE,this.SEPASTRIPE,this.EPS].includes(i)){t.next=6;break}return this.showError("Unknown payment option!",i),t.abrupt("return");case 6:if(o={},i===this.STRIPEID)return t.next=10,this.stripe.confirmCardPayment(a,{});t.next=14;break;case 10:(o=t.sent).error||(window.location=e.result.goto),t.next=116;break;case 14:if(i!==this.IDEALID)t.next=35;else{if(this.setCustomerDetails(n),(s={billing_details:this.getStripeBillingDetails(n)}).ideal=this.idealBank,(c=e.result).client_secret&&c.client_secret.startsWith("seti_"))return t.next=22,this.stripe.confirmIdealSetup(c.client_secret,{payment_method:s,return_url:e.goto});t.next=27}break;case 22:u=t.sent,(u=u.error)&&this.showError(u.message),t.next=32;break;case 27:return t.next=29,this.stripe.confirmIdealPayment(c.client_secret,{payment_method:s,return_url:e.goto});case 29:u=t.sent,(l=u.error)&&this.showError(l.message);case 32:return t.abrupt("return");case 35:if(i===this.EPS)return this.setCustomerDetails(n),(l={billing_details:{name:n.full_name||""}}).eps=this.epsBank,t.next=41,this.stripe.confirmEpsPayment(e.result.reference,{payment_method:l,return_url:e.result.goto});t.next=46;break;case 41:return(o=t.sent).error&&this.showError(o.error.message),t.abrupt("return");case 46:if(i===this.P24STRIPE)return this.setCustomerDetails(n),(p={billing_details:this.getStripeBillingDetails(n)}).p24=this.p24Bank,t.next=52,this.stripe.confirmP24Payment(e.result.reference,{payment_method:p,payment_method_options:{p24:{tos_shown_and_accepted:!0}},return_url:e.result.goto});t.next=57;break;case 52:return(o=t.sent).error&&this.showError(o.error.message),t.abrupt("return");case 57:if(i===this.KLARNASTRIPE)return this.setCustomerDetails(n),p={billing_details:this.getKlarnaBillingDetails(n)},t.next=62,this.stripe.confirmKlarnaPayment(e.result.client_secret,{payment_method:p,return_url:e.goto});t.next=67;break;case 62:return(o=t.sent).error&&this.showError(o.error.message),t.abrupt("return");case 67:if(i!==this.BANCONTACTSTRIPE)t.next=83;else{if(this.setCustomerDetails(n),d={billing_details:{name:n.full_name||"",email:n.optin_email||""}},e.result.client_secret.startsWith("seti_"))return t.next=73,this.stripe.confirmBancontactSetup(e.result.client_secret,{payment_method:d,return_url:e.goto});t.next=76}break;case 73:o=t.sent,t.next=79;break;case 76:return t.next=78,this.stripe.confirmBancontactPayment(e.result.client_secret,{payment_method:d,return_url:e.goto});case 78:o=t.sent;case 79:return o.error&&this.showError(o.error.message),t.abrupt("return");case 83:if(i!==this.SOFORTSTRIPE)t.next=99;else{if(this.setCustomerDetails(n),h={sofort:{country:this.getAnyCountry(n)},billing_details:{name:n.full_name||"",email:n.optin_email||""}},e.result.client_secret.startsWith("seti_"))return t.next=89,this.stripe.confirmSofortSetup(e.result.client_secret,{payment_method:h,return_url:e.goto});t.next=92}break;case 89:o=t.sent,t.next=95;break;case 92:return t.next=94,this.stripe.confirmSofortPayment(e.result.client_secret,{payment_method:h,return_url:e.goto});case 94:o=t.sent;case 95:return o.error&&this.showError(o.error.message),t.abrupt("return");case 99:if(i!==this.SEPASTRIPE)t.next=116;else{if(f={billing_details:this.getStripeBillingDetails(n)},funnelish.isOrderForm()&&(f.sepa_debit=this.sepa),y="",e.result.client_secret.startsWith("seti_"))return t.next=106,this.stripe.confirmSepaDebitSetup(e.result.client_secret,{payment_method:f});t.next=110}break;case 106:(o=t.sent).error?this.showError(o.error.message):y=e.goto+"?setup_intent=".concat(o.setupIntent.id),t.next=114;break;case 110:return t.next=112,this.stripe.confirmSepaDebitPayment(e.result.client_secret,{payment_method:f});case 112:(o=t.sent).error?this.showError(o.error.message):y=e.goto+"?payment_intent=".concat(o.paymentIntent.id);case 114:return!o.error&&y&&(window.location=y),t.abrupt("return");case 116:o.error?this.showError(o.error.message):funnelish.isOTO();case 117:case"end":return t.stop()}},t,this)})),function(t,e,n){return r.apply(this,arguments)})},{key:"pay_oto",value:(n=_asyncToGenerator(_regeneratorRuntime().mark(function t(e,n){var r,a,i,o,s,c,u,l;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=[],0===e?funnelish.getSelectedProducts().forEach(function(t){r.push({product_id:t.product.id,qty:t.qty,variant_option1:t.variant_option1,variant_option2:t.variant_option2,variant_option3:t.variant_option3})}):r=[{product_id:e,qty:1}],a=funnelish.validateFields(),i=this.getCID(),o=this.getNumCookie("fpay_method_group_id"),c=this.getNumCookie("fpay_user_gateway_id"),s=this.getNumCookie("fpay_gateway_id"),c={user_gateway_id:c,gateway_group_id:o,gateway_id:s,cid:i},a){t.next=10;break}return t.abrupt("return");case 10:if(n&&(c.payment_reference=n),s===this.KLARNA)return this.klarnaInstance.authorizeOto(a,r),t.abrupt("return");t.next=16;break;case 16:if(s!==this.AIRWALLEX){t.next=24;break}if(u=funnelish.getCookie("fpay_airwallex_consent_id")){t.next=21;break}return this.fpay.showError("Couldn't process payment due to invalid consent id."),t.abrupt("return");case 21:c.extra={payment_consent_id:u},t.next=25;break;case 24:s===this.AIRWALLEX_IDEAL&&(c.extra={bank_name:funnelish.getCookie("fpay_ideal_bank")});case 25:return funnelish.startLoading(),t.prev=26,t.next=29,funnelish.post("/pay",_objectSpread(_objectSpread(_objectSpread({},funnelish.getAuthHeader()),c),{},{customer:a,products:r,is_oto:!0,discount_id:funnelish.discount?funnelish.discount.discount_id:null}));case 29:if((l=t.sent).success){t.next=34;break}throw l.error;case 34:if(s===this.AIRWALLEX)return t.next=37,this.airwallex.payOto(l);t.next=39;break;case 37:t.next=45;break;case 39:if(s===this.RAZORPAYID)return t.next=42,this.authRazorPay(l,a);t.next=44;break;case 42:t.next=45;break;case 44:s===this.KLARNASTRIPE||[this.P24STRIPE,this.EPS,this.IDEALID,this.BANCONTACTSTRIPE,this.SOFORTSTRIPE].includes(s)?this.authPayment(l,a):[this.SEPASTRIPE].includes(s)?window.location=l.result.goto:s==this.STRIPEID?l.result.needs_approval?this.authPayment(l,a):window.location=l.result.goto:l.result.goto?window.location=l.result.goto:l.result.needs_approval?this.authPayment(l,a):this.showError();case 45:t.next=52;break;case 47:t.prev=47,t.t0=t.catch(26),funnelish.stopLoading(),this.showError(this.parseError(t.t0)),console.error(t.t0);case 52:return t.prev=52,t.finish(52);case 54:case"end":return t.stop()}},t,this,[[26,47,52,54]])})),function(t,e){return n.apply(this,arguments)})},{key:"getNumCookie",value:function(t){t=funnelish.getCookie(t);return t?parseInt(t):0}},{key:"parseError",value:function(e){try{var t=JSON.parse(e);return t.message?t.message:null}catch(t){return e}}},{key:"setup_oto_step",value:function(){var t,e=this,n=this.getNumCookie("fpay_gateway_id"),r=null;for(t in this.paymentMethods){var a=this.paymentMethods[t];if(a.gateway_id===n){r=a;break}}r?([this.STRIPEID,this.P24STRIPE,this.EPS,this.IDEALID,this.KLARNASTRIPE,this.BANCONTACTSTRIPE,this.SOFORTSTRIPE].includes(n)?this.loadStripeSettings(r.user_gateway_id,n):r.gateway_id===this.RAZORPAYID?this.loadRazorPaySettings(r.user_gateway_id,r):r.gateway_id===this.KLARNA?new fPayKlarna(this,r).loadSettings():r.gateway_id===this.AIRWALLEX&&(this.airwallex=new fPayAirwallex(this,r),this.airwallex.loadSettings()),funnelish.on("oto_yes",function(t){e.pay_oto(t)},this)):(funnelish.isOTO()||funnelish.isOrderForm())&&console.error("Error: no valid payment method selected at order form.")}},{key:"load_typ_orders",value:function(){}}]);var n,r,e,a,i,o,t,s,c,u,l,p,d,h}();console.log("Funnelish pay loaded",funnelish),funnelish&&(instance=new appFPay,console.log("FPay registering"),funnelish.registerApp(instance.id,instance)),document.addEventListener("DOMContentLoaded",function(){funnelish&&funnelish.stopLoading()});